nohup: ignoring input
[NbConvertApp] Converting notebook src/ViT-Large/ViT-large_Cross_Val.ipynb to notebook
Traceback (most recent call last):
  File "/home/sprieto/anaconda3/envs/polyp_vit/bin/jupyter-nbconvert", line 11, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/jupyter_core/application.py", line 283, in launch_instance
    super().launch_instance(argv=argv, **kwargs)
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/traitlets/config/application.py", line 1075, in launch_instance
    app.start()
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 420, in start
    self.convert_notebooks()
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 597, in convert_notebooks
    self.convert_single_notebook(notebook_filename)
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 563, in convert_single_notebook
    output, resources = self.export_single_notebook(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 487, in export_single_notebook
    output, resources = self.exporter.from_filename(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 201, in from_filename
    return self.from_file(f, resources=resources, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 220, in from_file
    return self.from_notebook_node(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/exporters/notebook.py", line 36, in from_notebook_node
    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 154, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 353, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/preprocessors/base.py", line 48, in __call__
    return self.preprocess(nb, resources)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/asyncio/base_events.py", line 686, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/sprieto/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
trainer.show_results(train_results, save_img=True, img_name=RESULTS_IMG)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mAttributeError[0m                            Traceback (most recent call last)
Cell [0;32mIn[9], line 1[0m
[0;32m----> 1[0m [43mtrainer[49m[38;5;241;43m.[39;49m[43mshow_results[49m[43m([49m[43mtrain_results[49m[43m,[49m[43m [49m[43msave_img[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m[43m [49m[43mimg_name[49m[38;5;241;43m=[39;49m[43mRESULTS_IMG[49m[43m)[49m

File [0;32m~/deteccion_de_polipos_aplicando_ViT/utils/utils.py:727[0m, in [0;36mTrainModel.show_results[0;34m(self, dict, save_img, img_name)[0m
[1;32m    726[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mshow_results[39m([38;5;28mself[39m, [38;5;28mdict[39m, save_img[38;5;241m=[39m[38;5;28;01mFalse[39;00m, img_name[38;5;241m=[39m[38;5;124m"[39m[38;5;124mTmp_res.png[39m[38;5;124m"[39m):
[0;32m--> 727[0m     [43mgraph_utils[49m[38;5;241;43m.[39;49m[43mshow_results[49m[43m([49m[38;5;28;43mdict[39;49m[43m,[49m[43m [49m[43msave_img[49m[38;5;241;43m=[39;49m[43msave_img[49m[43m,[49m[43m [49m[43mimg_name[49m[38;5;241;43m=[39;49m[43mimg_name[49m[43m,[49m[43m [49m
[1;32m    728[0m [43m                             [49m[43meval_pred[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43meval_pred[49m[43m)[49m

File [0;32m~/deteccion_de_polipos_aplicando_ViT/utils/graph_utils.py:124[0m, in [0;36mshow_results[0;34m(dict, save_img, img_name, eval_pred)[0m
[1;32m    121[0m [38;5;28;01mfor[39;00m i, split [38;5;129;01min[39;00m [38;5;28menumerate[39m(eval_data):
[1;32m    122[0m     [38;5;28;01mfor[39;00m sample [38;5;129;01min[39;00m split:
[1;32m    123[0m         [38;5;66;03m# predichas[39;00m
[0;32m--> 124[0m         cx, cy, w, h [38;5;241m=[39m [43mbox_convert[49m[43m([49m[43msample[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mpred_bbox[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43min_fmt[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mxyxy[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mout_fmt[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mcxcywh[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m    125[0m         pred_bbox_centers[i][38;5;241m.[39mappend((cx, cy))
[1;32m    126[0m         pred_sum_areas [38;5;241m+[39m[38;5;241m=[39m w[38;5;241m*[39mh

File [0;32m~/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/torchvision/ops/boxes.py:226[0m, in [0;36mbox_convert[0;34m(boxes, in_fmt, out_fmt)[0m
[1;32m    224[0m         boxes [38;5;241m=[39m _box_xyxy_to_xywh(boxes)
[1;32m    225[0m     [38;5;28;01melif[39;00m out_fmt [38;5;241m==[39m [38;5;124m"[39m[38;5;124mcxcywh[39m[38;5;124m"[39m:
[0;32m--> 226[0m         boxes [38;5;241m=[39m [43m_box_xyxy_to_cxcywh[49m[43m([49m[43mboxes[49m[43m)[49m
[1;32m    227[0m [38;5;28;01melif[39;00m out_fmt [38;5;241m==[39m [38;5;124m"[39m[38;5;124mxyxy[39m[38;5;124m"[39m:
[1;32m    228[0m     [38;5;28;01mif[39;00m in_fmt [38;5;241m==[39m [38;5;124m"[39m[38;5;124mxywh[39m[38;5;124m"[39m:

File [0;32m~/anaconda3/envs/polyp_vit/lib/python3.12/site-packages/torchvision/ops/_box_convert.py:39[0m, in [0;36m_box_xyxy_to_cxcywh[0;34m(boxes)[0m
[1;32m     28[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21m_box_xyxy_to_cxcywh[39m(boxes: Tensor) [38;5;241m-[39m[38;5;241m>[39m Tensor:
[1;32m     29[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[1;32m     30[0m [38;5;124;03m    Converts bounding boxes from (x1, y1, x2, y2) format to (cx, cy, w, h) format.[39;00m
[1;32m     31[0m [38;5;124;03m    (x1, y1) refer to top left of bounding box[39;00m
[0;32m   (...)[0m
[1;32m     37[0m [38;5;124;03m        boxes (Tensor(N, 4)): boxes in (cx, cy, w, h) format.[39;00m
[1;32m     38[0m [38;5;124;03m    """[39;00m
[0;32m---> 39[0m     x1, y1, x2, y2 [38;5;241m=[39m [43mboxes[49m[38;5;241;43m.[39;49m[43munbind[49m([38;5;241m-[39m[38;5;241m1[39m)
[1;32m     40[0m     cx [38;5;241m=[39m (x1 [38;5;241m+[39m x2) [38;5;241m/[39m [38;5;241m2[39m
[1;32m     41[0m     cy [38;5;241m=[39m (y1 [38;5;241m+[39m y2) [38;5;241m/[39m [38;5;241m2[39m

[0;31mAttributeError[0m: 'list' object has no attribute 'unbind'

